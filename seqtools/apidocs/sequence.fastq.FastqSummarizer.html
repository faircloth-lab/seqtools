<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>sequence.fastq.FastqSummarizer : API documentation</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
    <link href="apidocs.css" type="text/css" rel="stylesheet" />
    
    
  </head>
  <body>
    <h1 class="class">s.f.FastqSummarizer : class documentation</h1>
    <p>
      <span id="part">Part of <a href="sequence.html">sequence</a>.<a href="sequence.fastq.html">fastq</a></span>
      
      <a href="classIndex.html#sequence.fastq.FastqSummarizer">View In Hierarchy</a>
    </p>
    <div>
      
    </div>
    <div><p>Represents a class for deriving summary data across a number of reads. 
Renamed from FastaAggregator in the original code</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>fastqs = fastq.FastqReader(<span class="py-string">'../tests/test-data/sequence_for_summarizer.fastq'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>fastq_stats = fastq.FastqSummarizer()
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> read <span class="py-keyword">in</span> fastqs:
<span class="py-more">... </span>   fastq_stats.add(read)
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-comment"># get summary values for a column - column[0] is the first base of all reads, </span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-comment"># so we are getting a summary of the first base positions across all reads in </span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-comment"># fastqs</span>
<span class="py-prompt">&gt;&gt;&gt; </span>summary_stats = fastq_stats.get_summary_for_column(0)</pre>
<table class="fieldTable"></table></div>

    
    
    <div id="splitTables">
      <table class="children sortable" id="id16">
  
  
<tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#__init__">__init__</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#add">add</a></td>
    <td><span>Add a read to the fastq aggregator</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_decimal_range">get_decimal_range</a></td>
    <td><span>Return a tuple giving the (min, max) quality values for aggregated</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_length_counts">get_length_counts</a></td>
    <td><span>Return a dictionary of read length counts</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_max_read_length">get_max_read_length</a></td>
    <td><span>Return the maximum read length</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_min_read_length">get_min_read_length</a></td>
    <td><span>Return the minumum read length</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_read_count_for_column">get_read_count_for_column</a></td>
    <td><span>Return the count of reads with a base in column</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_read_count">get_read_count</a></td>
    <td><span>Return the total count of reads</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_base_counts_for_column">get_base_counts_for_column</a></td>
    <td><span>Return a dictionary of counts for each base in a column</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_all_scores_for_column">get_all_scores_for_column</a></td>
    <td><span>Return an array of quality scores for a column, including any NaNs</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_finite_scores_for_column">get_finite_scores_for_column</a></td>
    <td><span>Return an array of quality scores for a column, excluding any NaNs</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_nan_count_for_column">get_nan_count_for_column</a></td>
    <td><span>Return the count of NaNs for a column</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_quality_min_for_column">get_quality_min_for_column</a></td>
    <td><span>Return the minimum quality score for a column (always exludes NaNs)</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_quality_max_for_column">get_quality_max_for_column</a></td>
    <td><span>Return the maximum quality score for a column (always exludes NaNs)</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_quality_average_for_column">get_quality_average_for_column</a></td>
    <td><span>Return the average quality score for a column (always excludes NaNs)</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_quality_std_deviation_for_column">get_quality_std_deviation_for_column</a></td>
    <td><span>Return the standard deviation of the quality for a column (always 
excludes NaNs)</span></td>
  </tr><tr class="method">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#get_summary_for_column">get_summary_for_column</a></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="method private">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#_count_bases">_count_bases</a></td>
    <td><span>PRIVATE: Return an array of base counts by column across all 
sequences</span></td>
  </tr><tr class="method private">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#_nans">_nans</a></td>
    <td><span>PRIVATE helper method to return an array filled with NaNs</span></td>
  </tr><tr class="method private">
    
    
    <td>Method</td>
    <td><a href="sequence.fastq.FastqSummarizer.html#_array_qualities">_array_qualities</a></td>
    <td><span>PRIVATE: Return stacked quality arrays for reads into an array, 
buffering</span></td>
  </tr>
  
</table>
      
      
    </div>
    
    
    

    <div class="function">
  <a name="sequence.fastq.FastqSummarizer.__init__">
    
  </a>
  <a name="__init__">
    
  </a>
  <div class="functionHeader">
    
    def
    __init__(self):
    
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer._count_bases">
    
  </a>
  <a name="_count_bases">
    
  </a>
  <div class="functionHeader">
    
    def
    _count_bases(self, sequence):
    
  </div>
  <div class="functionBody">
    
    <pre>PRIVATE: Return an array of base counts by column across all sequences
aggregated.

The array returned looks something like the following, when several 
(n=2) sequences are aggregated:

    array([[ 0.,  1.,  0.,  1.,  0.],
           [ 0.,  0.,  0.,  2.,  0.],
           [ 0.,  0.,  0.,  2.,  0.],
           ...
           ])

where each row represents a base position - thus row[0] is the count
for sequence position 0.  The values within the vector give the counts
of each possible base where the index is given in self.nucleotide_positions
(in __init__):

    self.nucleotide_positions = {'A':0, 'C':1, 'G':2, 'T':3, 'N':4}

Using numpy arrays lets us quickly sum across columns or rows, making
summary stats easier.</pre>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer._nans">
    
  </a>
  <a name="_nans">
    
  </a>
  <div class="functionHeader">
    
    def
    _nans(self, shape, dtype=numpy.float32):
    
  </div>
  <div class="functionBody">
    
    <div>PRIVATE helper method to return an array filled with NaNs<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer._array_qualities">
    
  </a>
  <a name="_array_qualities">
    
  </a>
  <div class="functionHeader">
    
    def
    _array_qualities(self, quality):
    
  </div>
  <div class="functionBody">
    
    <pre>PRIVATE: Return stacked quality arrays for reads into an array, buffering 
read lengths to maximum encountered by appending numpy.NaNs to shorter
reads.

The returned array looks something like the following when several
(n=3) sequences are aggregated:

    array([[ 17.,  17.,  17.,  17.,  17.,  17.,  17.],
           [ 17.,  17.,  17.,  17.,  17.,  17.,  17.],
           [ 17.,  17.,  17.,  17.,  17.,  17.,  17..]], dtype=float32)

where each row of values represents the quality array of a sequence.
Thus, we can min/max "down" columns to get the min/max over a particular
base, across reads to get the per-read min/max, or over the entire
array to get the overall min/max.</pre>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.add">
    
  </a>
  <a name="add">
    
  </a>
  <div class="functionHeader">
    
    def
    add(self, read):
    
  </div>
  <div class="functionBody">
    
    <div><p>Add a read to the fastq aggregator</p>
<p>In essence, we are building a &quot;stack&quot; of read data across all 
reads we `add`. In order to generate summary statistics across some number 
of reads, N, we need to add those reads to the aggregator, and then we can 
compute our summary values across the reads that we add.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>fastqs = fastq.FastqReader(<span class="py-string">'../tests/test-data/sequence_for_summarizer.fastq'</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>fastq_stats = fastq.FastqSummarizer()
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> read <span class="py-keyword">in</span> fastqs:
<span class="py-more">... </span>   fastq_stats.add(read)</pre>
<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_decimal_range">
    
  </a>
  <a name="get_decimal_range">
    
  </a>
  <div class="functionHeader">
    
    def
    get_decimal_range(self):
    
  </div>
  <div class="functionBody">
    
    <div>Return a tuple giving the (min, max) quality values for aggregated 
reads<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_length_counts">
    
  </a>
  <a name="get_length_counts">
    
  </a>
  <div class="functionHeader">
    
    def
    get_length_counts(self):
    
  </div>
  <div class="functionBody">
    
    <div>Return a dictionary of read length counts<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_max_read_length">
    
  </a>
  <a name="get_max_read_length">
    
  </a>
  <div class="functionHeader">
    
    def
    get_max_read_length(self):
    
  </div>
  <div class="functionBody">
    
    <div>Return the maximum read length<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_min_read_length">
    
  </a>
  <a name="get_min_read_length">
    
  </a>
  <div class="functionHeader">
    
    def
    get_min_read_length(self):
    
  </div>
  <div class="functionBody">
    
    <div>Return the minumum read length<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_read_count_for_column">
    
  </a>
  <a name="get_read_count_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_read_count_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the count of reads with a base in column<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_read_count">
    
  </a>
  <a name="get_read_count">
    
  </a>
  <div class="functionHeader">
    
    def
    get_read_count(self):
    
  </div>
  <div class="functionBody">
    
    <div>Return the total count of reads<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_base_counts_for_column">
    
  </a>
  <a name="get_base_counts_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_base_counts_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return a dictionary of counts for each base in a column<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_all_scores_for_column">
    
  </a>
  <a name="get_all_scores_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_all_scores_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return an array of quality scores for a column, including any NaNs<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_finite_scores_for_column">
    
  </a>
  <a name="get_finite_scores_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_finite_scores_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return an array of quality scores for a column, excluding any NaNs<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_nan_count_for_column">
    
  </a>
  <a name="get_nan_count_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_nan_count_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the count of NaNs for a column<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_quality_min_for_column">
    
  </a>
  <a name="get_quality_min_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_quality_min_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the minimum quality score for a column (always exludes NaNs)<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_quality_max_for_column">
    
  </a>
  <a name="get_quality_max_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_quality_max_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the maximum quality score for a column (always exludes NaNs)<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_quality_average_for_column">
    
  </a>
  <a name="get_quality_average_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_quality_average_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the average quality score for a column (always excludes NaNs)<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_quality_std_deviation_for_column">
    
  </a>
  <a name="get_quality_std_deviation_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_quality_std_deviation_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div>Return the standard deviation of the quality for a column (always 
excludes NaNs)<table class="fieldTable"></table></div>
  </div>
</div><div class="function">
  <a name="sequence.fastq.FastqSummarizer.get_summary_for_column">
    
  </a>
  <a name="get_summary_for_column">
    
  </a>
  <div class="functionHeader">
    
    def
    get_summary_for_column(self, column):
    
  </div>
  <div class="functionBody">
    
    <div class="undocumented">Undocumented</div>
  </div>
</div>
    <address>
      <a href="index.html">API Documentation</a> for sequence, generated by <a href="http://codespeak.net/~mwh/pydoctor/">pydoctor</a> at 2011-03-25 12:10:35.
    </address>
  </body>
</html>